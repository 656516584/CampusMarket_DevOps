(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-df3845e6"],{"6e0a":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-page"},[a("el-card",{staticClass:"filter-card",attrs:{shadow:"always"}},[a("el-form",{staticClass:"filter-form",attrs:{inline:!0,size:"small","label-width":"auto"}},[a("el-form-item",{attrs:{label:"类别"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},on:{change:t.fetchFreshData},model:{value:t.productQueryDto.categoryId,callback:function(e){t.$set(t.productQueryDto,"categoryId",e)},expression:"productQueryDto.categoryId"}},t._l(t.categoryList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"时间范围"}},[a("el-date-picker",{staticStyle:{width:"250px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.fetchFreshData},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}})],1),a("el-form-item",{attrs:{label:"商品名"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入关键词",clearable:""},on:{clear:t.handleFilterClear},model:{value:t.productQueryDto.name,callback:function(e){t.$set(t.productQueryDto,"name",e)},expression:"productQueryDto.name"}},[a("el-button",{staticStyle:{"background-color":"#4a90e2"},attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleFilter},slot:"append"})],1)],1)],1)],1),a("el-card",{staticClass:"table-card",attrs:{shadow:"hover"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:!0,data:t.tableData}},[a("el-table-column",{attrs:{label:"头像",width:"70"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-avatar",{attrs:{size:32,src:t.row.userAvatar}})]}}])}),a("el-table-column",{attrs:{prop:"userName",label:"用户",width:"140"}}),a("el-table-column",{attrs:{prop:"name",label:"商品名"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"类别",width:"110"}}),a("el-table-column",{attrs:{label:"价格",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"price-text"},[t._v("￥"+t._s(e.row.price))])]}}])}),a("el-table-column",{attrs:{prop:"inventory",label:"库存",width:"90"}}),a("el-table-column",{attrs:{prop:"createTime",label:"发布时间",width:"160",sortable:!0}}),a("el-table-column",{attrs:{label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"pagination-wrapper"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,"page-sizes":[10,20],layout:"total, sizes, prev, pager, next, jumper",total:t.totalItems},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),a("el-drawer",{attrs:{title:"商品详情",visible:t.drawerProductOperaion,direction:t.direction,size:"40%"},on:{"update:visible":function(e){t.drawerProductOperaion=e}}},[a("div",{staticClass:"drawer-body"},[a("h4",[t._v("产品封面图")]),a("div",{staticClass:"cover-list"},t._l(t.coverList,(function(e,r){return a("div",{key:r,staticClass:"cover-item",on:{click:function(a){return t.coverExpansion(e)}}},[a("img",{attrs:{src:e}})])})),0),a("h4",{staticStyle:{"margin-top":"16px"}},[t._v("商品详情")]),a("div",{staticClass:"product-description",domProps:{innerHTML:t._s(t.data.detail)}})])]),a("el-dialog",{attrs:{visible:t.dialogCoverExpansion,width:"40%"},on:{"update:visible":function(e){t.dialogCoverExpansion=e}}},[a("div",{staticClass:"cover-preview"},[a("img",{attrs:{src:t.cover}})])])],1)},i=[],s={data(){return{data:{},currentPage:1,coverList:[],searchTime:[],cover:null,pageSize:10,totalItems:0,drawerProductOperaion:!1,isOperation:!1,tableData:[],delectedRows:[],dialogCoverExpansion:!1,productQueryDto:{},direction:"rtl",categoryList:[],bargainSelectedItem:{}}},created(){this.fetchCategoryList(),this.fetchFreshData(),this.bargainSelected(this.bargainStatus[0])},methods:{bargainSelected(t){this.bargainSelectedItem=t,this.productQueryDto.isBargain=t.isBargain,this.fetchFreshData()},fetchCategoryList(){this.$axios.post("/category/query",{}).then(t=>{const{data:e}=t;200===e.code&&(this.categoryList=e.data,this.categoryList.unshift({id:null,name:"全部"}))}).catch(t=>{console.log("商品类别查询异常：",t)})},coverExpansion(t){this.cover=t,this.dialogCoverExpansion=!0},cannel(){this.data={},this.drawerProductOperaion=!1,this.isOperation=!1},async batchDelete(){if(!this.delectedRows.length)return void this.$message("未选中任何数据");const t=await this.$swalConfirm({title:"删除商品数据",text:"删除后不可恢复，是否继续？",icon:"warning"});if(t)try{let t=this.delectedRows.map(t=>t.id);const e=await this.$axios.post("/product/batchDelete",t);if(200===e.data.code)return this.$notify({duration:1e3,title:"信息删除",message:"删除成功",type:"success"}),void this.fetchFreshData()}catch(e){this.$message.error("商品信息删除异常：",e),console.error("商品信息删除异常：",e)}},async fetchFreshData(){let t=null,e=null;if(null!=this.searchTime&&2===this.searchTime.length){const[a,r]=await Promise.all(this.searchTime.map(t=>t.toISOString()));t=a.split("T")[0]+"T00:00:00",e=r.split("T")[0]+"T23:59:59"}this.productQueryDto.current=this.currentPage,this.productQueryDto.size=this.pageSize,this.productQueryDto.startTime=t,this.productQueryDto.endTime=e,this.$axios.post("/product/query",this.productQueryDto).then(t=>{const{data:e}=t;200===e.code&&(this.tableData=e.data,this.totalItems=e.total)}).catch(t=>{this.$notify.error({title:"查询操作",message:t})})},add(){this.drawerProductOperaion=!0},handleFilter(){this.currentPage=1,this.fetchFreshData()},handleFilterClear(){this.handleFilter()},handleSizeChange(t){this.pageSize=t,this.currentPage=1,this.fetchFreshData()},handleCurrentChange(t){this.currentPage=t,this.fetchFreshData()},parseCoverList(t){this.coverList=t.split(",")},handleEdit(t){this.data=t,this.parseCoverList(t.coverList),this.drawerProductOperaion=!0},handleDelete(t){this.delectedRows.push(t),this.batchDelete()}}},l=s,o=(a("80c1"),a("2877")),c=Object(o["a"])(l,r,i,!1,null,"0fb7d360",null);e["default"]=c.exports},"80c1":function(t,e,a){"use strict";a("84b0")},"84b0":function(t,e,a){}}]);
//# sourceMappingURL=chunk-df3845e6.d5d3da02.js.map