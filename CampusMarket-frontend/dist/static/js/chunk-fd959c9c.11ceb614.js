(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fd959c9c"],{"06e3":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"nav-category"},[s("div",{staticClass:"right"},[s("el-date-picker",{staticStyle:{width:"216px","margin-right":"5px"},attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"发布开始","end-placeholder":"发布结束"},on:{change:t.fetchFreshData},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}}),s("el-input",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"最低价"},on:{change:function(e){return t.handlePriceChange("priceMin",e)}},model:{value:t.productQueryDto.priceMin,callback:function(e){t.$set(t.productQueryDto,"priceMin",e)},expression:"productQueryDto.priceMin"}}),s("span",{staticStyle:{"margin-right":"5px"}},[t._v("-")]),s("el-input",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"最高价"},on:{change:function(e){return t.handlePriceChange("priceMax",e)}},model:{value:t.productQueryDto.priceMax,callback:function(e){t.$set(t.productQueryDto,"priceMax",e)},expression:"productQueryDto.priceMax"}}),s("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"商品类别"},on:{change:t.fetchFreshData},model:{value:t.productQueryDto.categoryId,callback:function(e){t.$set(t.productQueryDto,"categoryId",e)},expression:"productQueryDto.categoryId"}},t._l(t.isUseCategoryList,(function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)]),s("div",{staticClass:"product-list"},[0===t.productList.length?s("el-row",[s("el-empty",{attrs:{description:"暂无商品信息"}})],1):s("el-row",t._l(t.productList,(function(e,i){return s("el-col",{key:i,attrs:{span:6},nativeOn:{click:function(s){return t.route(e)}}},[s("div",{staticClass:"item-product",staticStyle:{position:"relative"}},[s("div",{staticClass:"cover"},[s("img",{attrs:{src:t.coverListParse(e),alt:"",srcset:""}}),e.isRecommended?s("div",{staticClass:"recommend-tag",staticStyle:{position:"absolute",right:"10px",top:"10px"}},[t._v(" 猜你喜欢 ")]):t._e(),s("div",{staticClass:"price-box"},[s("span",{staticClass:"decimel-symbol"},[t._v("¥")]),s("span",{staticClass:"price"},[t._v(t._s(e.price))])])]),s("div",{staticStyle:{display:"flex","justify-content":"left",gap:"4px","align-items":"center"}},[s("span",{staticClass:"title"},[t._v(" "+t._s(e.name)+" ")])]),s("div",{staticClass:"info"},[s("img",{attrs:{src:e.userAvatar,alt:"",srcset:""}}),s("span",[t._v(t._s(e.userName))]),s("span",{staticClass:"love"},[t._v(t._s(e.likeNumber)+"人想要")])])])])})),1)],1)])},a=[],r=s("5d2d"),c={name:"Product",data(){return{categoryList:[],isUseCategoryList:[],categorySelectedItem:{},productQueryDto:{priceMin:null,priceMax:null},productList:[],recommendedProducts:[],bargainSelectedItem:{},searchTime:[],searchPath:"/search",bargainStatus:[{isBargain:null,name:"全部"},{isBargain:!0,name:"支持砍价"},{isBargain:!1,name:"不支持砍价"}]}},created(){this.fetchFreshData(),this.fetchCategoryList(),this.bargainSelected(this.bargainStatus[0])},methods:{route(t){this.$router.push("/product-detail?productId="+t.id)},fetch(){Object(r["g"])(this.key),this.handleRouteSelect(this.searchPath)},handleRouteSelect(t){this.$router.currentRoute.fullPath!==t&&this.$router.push(t)},coverListParse(t){if(null===t.coverList)return;const e=t.coverList.split(",");return e[0]},bargainSelected(t){this.bargainSelectedItem=t,this.productQueryDto.isBargain=t.isBargain,this.fetchFreshData()},async fetchFreshData(){let t=null,e=null;if(null!=this.searchTime&&2===this.searchTime.length){const[s,i]=await Promise.all(this.searchTime.map(t=>t.toISOString()));t=s.split("T")[0]+"T00:00:00",e=i.split("T")[0]+"T23:59:59"}this.productQueryDto.startTime=t,this.productQueryDto.endTime=e,this.$axios.post("/product/query",this.productQueryDto).then(t=>{const{data:e}=t;200===e.code&&(this.productList=e.data),this.$axios.get("/product/recommend").then(t=>{const{data:e}=t;200===e.code&&(this.recommendedProducts=e.data),this.mergeProducts()}).catch(t=>{console.log("推荐商品查询异常：",t)})}).catch(t=>{console.log("商品查询异常：",t)})},mergeProducts(){const t=new Set(this.recommendedProducts.map(t=>t.id)),e=this.productList.map(e=>({...e,isRecommended:t.has(e.id)})),s=e.filter(t=>t.isRecommended),i=e.filter(t=>!t.isRecommended);this.productList=[...s,...i]},categorySelected(t){this.categorySelectedItem=t,this.productQueryDto.categoryId=t.id,this.fetchFreshData()},fetchCategoryList(){this.$axios.post("/category/query",{}).then(t=>{const{data:e}=t;200===e.code&&(this.categoryList=e.data,this.isUseCategoryList=e.data.filter(t=>t.isUse),this.isUseCategoryList.unshift({id:null,name:"全部"}),this.categorySelected(this.isUseCategoryList[0]))}).catch(t=>{console.log("商品类别查询异常：",t)})},handlePriceChange(t,e){if(""===e||isNaN(e))this.productQueryDto[t]=null;else{const s=Number(e);this.productQueryDto[t]=s>=0?s:null}this.fetchFreshData()}}},o=c,n=(s("5f7f"),s("2877")),l=Object(n["a"])(o,i,a,!1,null,"df0548e6",null);e["default"]=l.exports},3770:function(t,e,s){},"5f7f":function(t,e,s){"use strict";s("3770")}}]);
//# sourceMappingURL=chunk-fd959c9c.11ceb614.js.map