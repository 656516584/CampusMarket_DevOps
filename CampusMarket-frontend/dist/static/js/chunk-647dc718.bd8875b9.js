(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-647dc718"],{83446:function(t,e,s){"use strict";s("b128")},b128:function(t,e,s){},e5dc:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-product-wrapper"},[s("h2",{staticClass:"title"},[t._v("编辑商品")]),s("div",{staticClass:"form-section"},[s("el-card",{staticClass:"card"},[s("p",{staticClass:"label"},[t._v("商品名")]),s("el-input",{attrs:{placeholder:"请输入商品名",clearable:""},model:{value:t.product.name,callback:function(e){t.$set(t.product,"name",e)},expression:"product.name"}}),s("p",{staticClass:"label"},[t._v("新旧程度")]),s("el-input-number",{attrs:{min:1,max:10},model:{value:t.product.oldLevel,callback:function(e){t.$set(t.product,"oldLevel",e)},expression:"product.oldLevel"}}),s("p",{staticClass:"label"},[t._v("价格")]),s("el-input",{attrs:{placeholder:"请输入价格","prefix-icon":"el-icon-money",clearable:""},model:{value:t.product.price,callback:function(e){t.$set(t.product,"price",e)},expression:"product.price"}})],1),s("el-card",{staticClass:"card"},[s("p",{staticClass:"label"},[t._v("产品图")]),s("el-upload",{attrs:{action:"https://market.charactex.com:11451/api/campus-product-sys/v1.0/file/upload","list-type":"picture-card","on-success":t.handlePictureCardSuccess,"file-list":t.coverList,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[s("i",{staticClass:"el-icon-plus"})]),s("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),s("el-card",{staticClass:"card"},[s("p",{staticClass:"label"},[t._v("商品类别")]),s("div",{staticClass:"category-list"},t._l(t.categoryList,(function(e,a){return s("span",{key:a,staticClass:"category-item",class:{selected:t.categorySelected.id===e.id},on:{click:function(s){return t.categoryClick(e)}}},[t._v(" "+t._s(e.name)+" ")])})),0),s("p",{staticClass:"label"},[t._v("库存")]),s("el-input-number",{attrs:{min:1,max:1e4},model:{value:t.product.inventory,callback:function(e){t.$set(t.product,"inventory",e)},expression:"product.inventory"}})],1),s("el-card",{staticClass:"card"},[s("p",{staticClass:"label"},[t._v("商品详情")]),s("Editor",{attrs:{height:"300px",receiveContent:t.product.detail},on:{"on-receive":t.onReceive}})],1)],1),s("div",{staticClass:"action-bar"},[s("el-button",{attrs:{type:"primary",size:"large"},on:{click:t.editProduct}},[t._v("修改商品")])],1)])},i=[],o=s("ceb0"),c=s("5d2d"),r={components:{Editor:o["a"]},name:"PostProduct",data(){return{product:{},categorySelected:{},dialogImageUrl:"",dialogVisible:!1,coverList:[],categoryList:[]}},created(){this.getStorageProductInfo(),this.fetchCategoryList()},methods:{getStorageProductInfo(){this.product=Object(c["b"])(),this.coverListParse(this.product)},coverListParse(t){null!==t.coverList&&(this.coverList=t.coverList.split(",").map(t=>({uid:Date.now()+Math.floor(10001*Math.random()),name:Date.now()+Math.floor(10001*Math.random()),status:"success",url:t})))},editProduct(){if(void 0===this.product.name)return void this.$notify.info({duration:1e3,title:"填写提醒",message:"商品标题不能为空"});if(void 0===this.product.price)return void this.$notify.info({duration:1e3,title:"填写提醒",message:"商品价格不能为空"});if(0===this.coverList.length)return void this.$notify.info({duration:1e3,title:"上传提醒",message:"请上传封面"});const t=this.coverList.map(t=>t.url);this.product.coverList=t.join(","),this.$axios.put("/product/update",this.product).then(t=>{const{data:e}=t;200===e.code&&(this.$notify.success({title:"修改操作",message:e.msg}),this.$router.push("/myProduct"))}).catch(t=>{this.$notify.error({title:"修改操作",message:t}),console.log("修改商品异常:",t)})},onReceive(t){this.product.detail=t},categoryClick(t){this.categorySelected=t,this.product.categoryId=t.id},fetchCategoryList(){this.$axios.post("/category/query",{}).then(t=>{const{data:e}=t;200===e.code&&(this.categoryList=e.data,this.categoryClick(this.categoryList[0]))}).catch(t=>{console.log("查询商品类别信息异常:",t)})},handlePictureCardSuccess(t,e){this.coverList.push({uid:Date.now()+Math.floor(10001*Math.random()),name:Date.now()+Math.floor(10001*Math.random()),status:"success",url:t.data})},handleRemove(t,e){this.coverList=e,console.log(t,e)},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0}}},l=r,n=(s("83446"),s("2877")),d=Object(n["a"])(l,a,i,!1,null,"c57137d4",null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-647dc718.bd8875b9.js.map