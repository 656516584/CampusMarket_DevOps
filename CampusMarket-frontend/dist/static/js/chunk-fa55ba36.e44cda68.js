(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fa55ba36"],{"1e23":function(e,t,s){"use strict";s("5357")},"3ec9":function(e,t,s){"use strict";s("8d38")},5357:function(e,t,s){},"751f":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"购物订单",name:"first"}},[s("BuyOrders")],1),s("el-tab-pane",{attrs:{label:"我的订单",name:"second"}},[s("MyOrders")],1)],1)],1)])},a=[],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"orders-page"},[s("div",{staticClass:"orders-left"},[s("div",{staticClass:"condition"},[s("span",{staticClass:"trade"},e._l(e.tradeStatusList,(function(t,r){return s("span",{key:r,class:{active:e.tradeStatusSelectedItem.name===t.name},on:{click:function(s){return e.tradeStatusSelected(t)}}},[e._v(e._s(t.name))])})),0),s("el-input",{staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"订单号",clearable:""},on:{clear:e.handleFilterClear},model:{value:e.ordersQueryDto.code,callback:function(t){e.$set(e.ordersQueryDto,"code",t)},expression:"ordersQueryDto.code"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.fetchOrders},slot:"append"})],1)],1),0===e.ordersList.length?s("div",{staticClass:"empty-container"},[s("el-empty",{attrs:{description:"未找到符合条件的订单数据"}})],1):s("div",{staticClass:"orders-list"},e._l(e.ordersList,(function(t,r){return s("div",{key:r,staticClass:"item-order",on:{click:function(s){return e.selectOrder(t)}}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:t.cover,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[e._v(e._s(t.productTitle))]),s("div",{staticClass:"price"},[e._v("￥"+e._s(e.totalPrice(t)))])])])})),0)]),e.selectedOrder?s("div",{staticClass:"orders-right"},[s("div",{staticClass:"order-detail"},[s("h2",[e._v("订单详情")]),s("p",[s("strong",[e._v("订单号：")]),e._v(e._s(e.selectedOrder.code))]),s("p",[s("strong",[e._v("商品：")]),e._v(e._s(e.selectedOrder.productTitle))]),s("p",[s("strong",[e._v("数量：")]),e._v(e._s(e.selectedOrder.buyNumber))]),s("p",[s("strong",[e._v("价格：")]),e._v("￥"+e._s(e.totalPrice(e.selectedOrder)))]),s("p",[s("strong",[e._v("备注：")]),e._v(e._s(e.selectedOrder.detail))]),null!==e.selectedOrder.refundStatus?s("p",[s("strong",[e._v("退款状态：")]),s("span",{staticClass:"confirmed"},[e._v(" "+e._s(e.selectedOrder.isRefundConfirm?"钱款已原路返回":"申请退款中，待卖家确认...")+" ")])]):e._e(),s("div",{staticClass:"actions"},[e.selectedOrder.isRefundConfirm?e._e():s("span",[e.selectedOrder.tradeStatus?s("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.refund(e.selectedOrder)}}},[e._v("申请退款")]):s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.placeAnOrder(e.selectedOrder)}}},[e._v("下单")])],1),e.selectedOrder.tradeStatus?s("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.del(e.selectedOrder)}}},[e._v("删除")]):e._e()],1)])]):e._e()])},d=[],c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{visible:e.visible,title:"投诉"},on:{"update:visible":function(t){e.visible=t}}},[s("el-form",{nativeOn:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[s("el-form-item",{attrs:{label:"投诉内容"}},[s("el-input",{attrs:{type:"textarea",required:""},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),s("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)},n=[],o=s("bc3a"),l=s.n(o),u={props:["visible","targetId","orderId","complainantId"],data(){return{content:""}},methods:{async submit(){await l.a.post("/api/complaint/submit",{complainantId:this.complainantId,targetId:this.targetId,orderId:this.orderId,content:this.content}),this.$emit("update:visible",!1),this.$message.success("投诉已提交")}}},h=u,m=s("2877"),p=Object(m["a"])(h,c,n,!1,null,null,null),f=p.exports,v={name:"BuyOrders",components:{ComplaintForm:f},data(){return{selectedOrder:null,ordersList:[],ordersQueryDto:{},tradeStatusSelectedItem:{},tradeStatusList:[{tradeStatus:null,name:"全部"},{tradeStatus:!0,name:"已支付"},{tradeStatus:!1,name:"未支付"}],showComplaint:!1,userId:"",content:""}},created(){this.auth()},methods:{cannelComplaint(){this.showComplaint=!1},submitComplaint(){this.showComplaint=!0},auth(){this.$axios.get("/user/auth").then(e=>{const{data:t}=e;200===t.code&&(this.selfInfo=t.data,this.userId=this.selfInfo.id,this.fetchOrders(),this.tradeStatusSelected(this.tradeStatusList[0]))}).catch(e=>{this.$notify.error({title:"查询异常",message:e})})},async submit(){console.log(this.selectedOrder),await this.$axios.post("/api/complaint/submit",{complainantId:this.userId,targetId:this.selectedOrder.sellerId,orderId:this.selectedOrder.id,content:this.content}),this.$emit("update:visible",!1),this.$message.success("投诉已提交"),this.cannelComplaint()},tradeStatusSelected(e){this.tradeStatusSelectedItem=e,this.ordersQueryDto.tradeStatus=e.tradeStatus,this.fetchOrders()},selectOrder(e){this.selectedOrder=e},handleFilterClear(){this.ordersQueryDto.code="",this.fetchOrders()},async del(e){const t=await this.$swalConfirm({title:"删除订单数据",text:"删除后不可恢复，是否继续？",icon:"warning"});if(t)try{let t=[e.id];const s=await this.$axios.post("/orders/batchDelete",t);if(200===s.data.code)return this.$notify({duration:1e3,title:"信息删除",message:"删除成功",type:"success"}),void this.fetchOrders()}catch(s){this.$message.error("订单信息删除异常：",s),console.error("订单信息删除异常：",s)}},totalPrice(e){const t=e.buyNumber*e.buyPrice;return parseFloat(t).toFixed(2)},refund(e){this.$axios.post("/product/refund/"+e.id).then(e=>{const{data:t}=e;200===t.code&&(this.$notify({duration:1e3,title:"退款操作",message:"退款成功",type:"success"}),this.fetchOrders())}).catch(e=>{console.log("退款异常：",e)})},placeAnOrder(e){this.$axios.post("/product/placeAnOrder/"+e.id).then(e=>{const{data:t}=e;200===t.code&&(this.$notify({duration:1e3,title:"下单",message:"下单成功",type:"success"}),this.fetchOrders())}).catch(e=>{console.log("下单异常：",e)})},coverParse(e){if(null!==e.productCover)return e.productCover.split(",")[0]},fetchOrders(){this.$axios.post("/orders/queryUser",this.ordersQueryDto).then(e=>{const{data:t}=e;200===t.code&&(this.ordersList=t.data.map(e=>({id:e.id,code:e.code,productTitle:e.productTitle,detail:e.detail,buyPrice:e.buyPrice,buyNumber:e.buyNumber,tradeStatus:e.tradeStatus,tradeTime:e.tradeTime,refundStatus:e.refundStatus,refundTime:e.refundTime,isRefundConfirm:e.isRefundConfirm,createTime:e.createTime,tradeTime:e.tradeTime,refundTime:e.refundTime,cover:this.coverParse(e)})))}).catch(e=>{console.log("订单数据查询异常：",e)})}}},y=v,_=(s("3ec9"),Object(m["a"])(y,i,d,!1,null,"6247c8aa",null)),O=_.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"orders-page"},[s("div",{staticClass:"orders-left"},[s("div",{staticClass:"condition"},[s("span",{staticClass:"trade"},e._l(e.tradeStatusList,(function(t,r){return s("span",{key:r,class:{active:e.tradeStatusSelectedItem.name===t.name},on:{click:function(s){return e.tradeStatusSelected(t)}}},[e._v(e._s(t.name))])})),0),s("el-input",{staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"订单号",clearable:""},on:{clear:e.handleFilterClear},model:{value:e.ordersQueryDto.code,callback:function(t){e.$set(e.ordersQueryDto,"code",t)},expression:"ordersQueryDto.code"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.fetchOrders},slot:"append"})],1)],1),0===e.ordersList.length?s("div",{staticClass:"empty-container"},[s("el-empty",{attrs:{description:"未找到符合条件的订单数据"}})],1):s("div",{staticClass:"orders-list"},e._l(e.ordersList,(function(t,r){return s("div",{key:r,staticClass:"item-order",on:{click:function(s){return e.selectOrder(t)}}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:t.cover,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[e._v(e._s(t.productTitle))]),s("div",{staticClass:"price"},[e._v("￥"+e._s(e.totalPrice(t)))])])])})),0)]),e.selectedOrder?s("div",{staticClass:"orders-right"},[s("div",{staticClass:"order-detail"},[s("h2",[e._v("订单详情")]),s("p",[s("strong",[e._v("订单号：")]),e._v(e._s(e.selectedOrder.code))]),s("p",[s("strong",[e._v("商品：")]),e._v(e._s(e.selectedOrder.productTitle))]),s("p",[s("strong",[e._v("数量：")]),e._v(e._s(e.selectedOrder.buyNumber))]),s("p",[s("strong",[e._v("价格：")]),e._v("￥"+e._s(e.totalPrice(e.selectedOrder)))]),s("p",[s("strong",[e._v("备注：")]),e._v(e._s(e.selectedOrder.detail))]),e.selectedOrder.refundStatus?s("p",[s("strong",[e._v("退款状态：")]),s("span",{class:{confirmed:e.selectedOrder.isRefundConfirm}},[e._v(" "+e._s(e.selectedOrder.isRefundConfirm?"钱款已原路返回":"申请退款中，待卖家确认...")+" ")])]):e._e(),s("div",{staticClass:"actions"},[e.selectedOrder.refundStatus?s("span",{staticClass:"refund-status"},[e._v(" 钱款已经原路返回 ")]):s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.returnMoney(e.selectedOrder)}}},[e._v(" 确定退款 ")])],1)])]):e._e()])},C=[],S={name:"BuyOrders",data(){return{selectedOrder:null,ordersList:[],ordersQueryDto:{},tradeStatusSelectedItem:{},tradeStatusList:[{tradeStatus:null,name:"全部"},{tradeStatus:!0,name:"已支付"},{tradeStatus:!1,name:"未支付"}]}},created(){this.fetchOrders(),this.tradeStatusSelected(this.tradeStatusList[0])},methods:{tradeStatusSelected(e){this.tradeStatusSelectedItem=e,this.ordersQueryDto.tradeStatus=e.tradeStatus,this.fetchOrders()},selectOrder(e){this.selectedOrder=e},handleFilterClear(){this.ordersQueryDto.code="",this.fetchOrders()},async del(e){const t=await this.$swalConfirm({title:"删除订单数据",text:"删除后不可恢复，是否继续？",icon:"warning"});if(t)try{let t=[e.id];const s=await this.$axios.post("/orders/batchDelete",t);if(200===s.data.code)return this.$notify({duration:1e3,title:"信息删除",message:"删除成功",type:"success"}),void this.fetchOrders()}catch(s){this.$message.error("订单信息删除异常：",s),console.error("订单信息删除异常：",s)}},totalPrice(e){const t=e.buyNumber*e.buyPrice;return parseFloat(t).toFixed(2)},refund(e){this.$axios.post("/product/refund/"+e.id).then(e=>{const{data:t}=e;200===t.code&&(this.$notify({duration:1e3,title:"退款操作",message:"退款成功",type:"success"}),this.fetchOrders())}).catch(e=>{console.log("退款异常：",e)})},returnMoney(e){this.$axios.post("/orders/returnMoney/"+e.id).then(e=>{const{data:t}=e;200===t.code&&(this.$notify({duration:1e3,title:"退款",message:"退款成功",type:"success"}),this.fetchOrders())}).catch(e=>{console.log("退款异常：",e)})},coverParse(e){if(null!==e.productCover)return e.productCover.split(",")[0]},fetchOrders(){this.$axios.post("/orders/queryOrdersList",this.ordersQueryDto).then(e=>{const{data:t}=e;200===t.code&&(this.ordersList=t.data.map(e=>({id:e.id,code:e.code,productTitle:e.productTitle,detail:e.detail,buyPrice:e.buyPrice,buyNumber:e.buyNumber,tradeStatus:e.tradeStatus,tradeTime:e.tradeTime,refundStatus:e.refundStatus,refundTime:e.refundTime,isRefundConfirm:e.isRefundConfirm,createTime:e.createTime,tradeTime:e.tradeTime,refundTime:e.refundTime,cover:this.coverParse(e)})))}).catch(e=>{console.log("订单数据查询异常：",e)})}}},g=S,$=(s("1e23"),Object(m["a"])(g,b,C,!1,null,"41e560ac",null)),T=$.exports,k={components:{BuyOrders:O,MyOrders:T},name:"Orders",data(){return{activeName:"first"}},created(){},methods:{handleClick(e,t){}}},x=k,w=Object(m["a"])(x,r,a,!1,null,"8e1a71ac",null);t["default"]=w.exports},"8d38":function(e,t,s){}}]);
//# sourceMappingURL=chunk-fa55ba36.e44cda68.js.map