(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ad3a33f"],{"295a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat-table-container"},[e.loading?a("div",{staticClass:"loading"},[e._v("加载中...")]):e._e(),e.loading?e._e():a("el-table",{attrs:{data:e.chatList,stripe:"",border:"","header-cell-style":e.headerStyle,"row-style":e.rowStyle}},[a("el-table-column",{attrs:{label:"接收者",prop:"receiverName",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{staticClass:"receiver-btn",attrs:{type:"text"},on:{click:function(t){return e.goToChatPage(r.receiverId)}}},[e._v(" "+e._s(r.receiverName)+" ")])]}}],null,!1,2712301228)}),a("el-table-column",{attrs:{label:"最后消息",prop:"lastMessage"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{staticClass:"last-message",attrs:{title:r.lastMessage}},[e._v(e._s(r.lastMessage))])]}}],null,!1,2974481856)}),a("el-table-column",{attrs:{label:"最后消息时间",prop:"lastMessageTime",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{staticClass:"time"},[e._v(e._s(e.formatTime(r.lastMessageTime)))])]}}],null,!1,2031855060)})],1)],1)},s=[],i={name:"ChatTable",data(){return{senderId:"12345",chatList:[],loading:!1}},created(){this.loadChatList()},methods:{formatTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleString()},goToChatPage(e){this.$router.push({name:"Chat",params:{id:e}})},async loadChatList(){this.loading=!0;try{const e=await this.$axios.post("/chatTable/queryCurrentUser"),t={},a=await this.$axios.post("/chatTable/queryUser",t);if(200===a.data.code){const t=a.data.data;this.chatList=t.filter(e=>e.receiverId!=e.senderId).map(t=>{const a=t.receiverId==e.data?t.senderId:t.receiverId,r=t.receiverId==e.data?t.senderName:t.receiverName;return{receiverId:a,receiverName:r,lastMessage:t.content,lastMessageTime:new Date(t.createTime.replace("年","-").replace("月","-").replace("日",""))}})}else this.$message.error(a.data.msg)}catch(e){console.error("获取聊天列表失败:",e),this.$message.error("加载聊天列表失败")}finally{this.loading=!1}},goToChatPage(e){this.$router.push({path:"/chat",query:{ReceiverId:e}})},formatTime(e){return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}},computed:{headerStyle(){return{backgroundColor:"#2c69f0",color:"white",fontWeight:"600"}},rowStyle({rowIndex:e}){return e%2===0?{background:"#f5faff"}:{}}}},l=i,o=(a("e4f0"),a("2877")),n=Object(o["a"])(l,r,s,!1,null,"4e110324",null);t["default"]=n.exports},b88d:function(e,t,a){},e4f0:function(e,t,a){"use strict";a("b88d")}}]);
//# sourceMappingURL=chunk-1ad3a33f.dad7137f.js.map