{"version":3,"sources":["webpack:///./src/views/user/ChatTable.vue?c149","webpack:///src/views/user/ChatTable.vue","webpack:///./src/views/user/ChatTable.vue?f74c","webpack:///./src/views/user/ChatTable.vue","webpack:///./src/views/user/ChatTable.vue?8966"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_e","loading","attrs","chatList","headerStyle","rowStyle","scopedSlots","_u","key","fn","ref","row","on","$event","goToChatPage","receiverId","_s","receiverName","lastMessage","formatTime","lastMessageTime","staticRenderFns","name","senderId","loadChatList","methods","time","date","Date","toLocaleString","$router","push","currentId","chatterQueryDto","response","$axios","post","data","code","item","content","createTime","replace","$message","error","msg","console","toLocaleTimeString","computed","backgroundColor","color","fontWeight","rowIndex","component"],"mappings":"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","file":"static/js/chunk-1ad3a33f.dad7137f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat-table-container\"},[(_vm.loading)?_c('div',{staticClass:\"loading\"},[_vm._v(\"加载中...\")]):_vm._e(),(!_vm.loading)?_c('el-table',{attrs:{\"data\":_vm.chatList,\"stripe\":\"\",\"border\":\"\",\"header-cell-style\":_vm.headerStyle,\"row-style\":_vm.rowStyle}},[_c('el-table-column',{attrs:{\"label\":\"接收者\",\"prop\":\"receiverName\",\"width\":\"180\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('el-button',{staticClass:\"receiver-btn\",attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.goToChatPage(row.receiverId)}}},[_vm._v(\" \"+_vm._s(row.receiverName)+\" \")])]}}],null,false,2712301228)}),_c('el-table-column',{attrs:{\"label\":\"最后消息\",\"prop\":\"lastMessage\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('span',{staticClass:\"last-message\",attrs:{\"title\":row.lastMessage}},[_vm._v(_vm._s(row.lastMessage))])]}}],null,false,2974481856)}),_c('el-table-column',{attrs:{\"label\":\"最后消息时间\",\"prop\":\"lastMessageTime\",\"width\":\"160\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('span',{staticClass:\"time\"},[_vm._v(_vm._s(_vm.formatTime(row.lastMessageTime)))])]}}],null,false,2031855060)})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"chat-table-container\">\n    <div v-if=\"loading\" class=\"loading\">加载中...</div>\n\n    <el-table :data=\"chatList\" v-if=\"!loading\" stripe border :header-cell-style=\"headerStyle\" :row-style=\"rowStyle\">\n      <el-table-column label=\"接收者\" prop=\"receiverName\" width=\"180\">\n        <template #default=\"{ row }\">\n          <el-button @click=\"goToChatPage(row.receiverId)\" type=\"text\" class=\"receiver-btn\">\n            {{ row.receiverName }}\n          </el-button>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"最后消息\" prop=\"lastMessage\">\n        <template #default=\"{ row }\">\n          <span class=\"last-message\" :title=\"row.lastMessage\">{{ row.lastMessage }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"最后消息时间\" prop=\"lastMessageTime\" width=\"160\">\n        <template #default=\"{ row }\">\n          <span class=\"time\">{{ formatTime(row.lastMessageTime) }}</span>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ChatTable',\n  data() {\n    return {\n      senderId: '12345',  // 当前用户的 senderId, 需要根据实际情况动态获取\n      chatList: [],\n      loading: false,\n    };\n  },\n  created() {\n    this.loadChatList(); // 获取聊天记录\n  },\n  methods: {\n    formatTime(time) {\n      if (!time) return '';\n      const date = new Date(time);\n      return date.toLocaleString();\n    },\n    goToChatPage(receiverId) {\n      // 这里写跳转聊天页面的逻辑\n      this.$router.push({ name: 'Chat', params: { id: receiverId } });\n    },\n    // 获取该 senderId 所有接收者的聊天记录\n    async loadChatList() {\n      this.loading = true;\n      try {\n        // 发起请求获取聊天记录\n        const currentId=await this.$axios.post('/chatTable/queryCurrentUser')\n        const chatterQueryDto = {};\n        const response = await this.$axios.post(`/chatTable/queryUser`,chatterQueryDto);\n        if (response.data.code === 200) {\n          const data = response.data.data;\n          this.chatList = data\n              .filter(item => item.receiverId != item.senderId)\n              .map((item) => {\n            // 处理每个接收者的聊天记录数据\n                const receiverId = item.receiverId == currentId.data ? item.senderId : item.receiverId;\n                const receiverName = item.receiverId == currentId.data ? item.senderName : item.receiverName;\n            return {\n              receiverId: receiverId,\n              receiverName: receiverName,\n              lastMessage: item.content,  // 获取最后一条消息内容\n              lastMessageTime: new Date(item.createTime.replace('年', '-').replace('月', '-').replace('日', '')),\n            };\n          });\n        } else {\n          this.$message.error(response.data.msg);\n        }\n      } catch (error) {\n        console.error('获取聊天列表失败:', error);\n        this.$message.error('加载聊天列表失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    // 点击接收者，跳转到该接收者的聊天界面\n    goToChatPage(receiverId) {\n      this.$router.push({ path: '/chat', query: { ReceiverId: receiverId } });\n    },\n\n    // 格式化时间\n    formatTime(time) {\n      return time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    }\n  },\n  computed: {\n    headerStyle() {\n      return {\n        backgroundColor: '#2c69f0',\n        color: 'white',\n        fontWeight: '600'\n      };\n    },\n    rowStyle({ rowIndex }) {\n      return rowIndex % 2 === 0 ? { background: '#f5faff' } : {};\n    }\n  }\n};\n</script>\n\n<style scoped lang=\"scss\">\n$primary-blue: #2c69f0;\n$light-blue-bg: #e6f0ff;\n$text-dark: #1a3a8f;\n$text-muted: #6780b3;\n$row-hover: #d9e7ff;\n\n.chat-table-container {\n  padding: 20px;\n  background-color: $light-blue-bg;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(44, 105, 240, 0.15);\n}\n\n.loading {\n  text-align: center;\n  font-size: 18px;\n  color: $text-muted;\n  padding: 40px 0;\n}\n\n.el-table {\n  background-color: white;\n  border-radius: 10px;\n  overflow: hidden;\n\n  .el-table__header-wrapper {\n    background-color: $primary-blue;\n    color: white;\n    font-weight: 600;\n    font-size: 14px;\n  }\n\n  .el-table__body-wrapper {\n    font-size: 14px;\n    color: $text-dark;\n  }\n}\n\n.receiver-btn {\n  color: $primary-blue;\n  font-weight: 600;\n  padding: 0;\n  text-transform: none;\n\n  &:hover {\n    background-color: transparent;\n    color: darken($primary-blue, 10%);\n    text-decoration: underline;\n  }\n}\n\n.last-message {\n  display: inline-block;\n  max-width: 300px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: $text-muted;\n}\n\n.time {\n  color: $text-muted;\n  font-size: 12px;\n}\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatTable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatTable.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChatTable.vue?vue&type=template&id=4e110324&scoped=true&\"\nimport script from \"./ChatTable.vue?vue&type=script&lang=js&\"\nexport * from \"./ChatTable.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChatTable.vue?vue&type=style&index=0&id=4e110324&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e110324\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatTable.vue?vue&type=style&index=0&id=4e110324&scoped=true&lang=scss&\""],"sourceRoot":""}